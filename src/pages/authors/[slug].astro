---
import authors from '../../data/authors.json';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  // Genera un path por cada autor en el JSON con el prefijo @
  return authors.map(author => ({ params: { slug: `@${author.id}` } }));
}

const { slug } = Astro.params;
const authorId = slug.replace('@', ''); // Elimina el prefijo @ para buscar el autor
const author = authors.find(a => a.id === authorId);
const posts = (await getCollection('blog')).filter(post => post.data.author === authorId);
---

{author ? (
  <>
    <!--<AuthorCard author={author} />-->
    <h2>Artículos de {author.name}</h2>
    <ul>
      {posts.length > 0 ? posts.map(post => (
        <li><a href={`/blog/${post.id}/`}>{post.data.title}</a></li>
      )) : <li>No hay artículos para este autor.</li>}
    </ul>
  </>
) : (
  <p>Autor no encontrado.</p>
)}
